{% extends "base.html" %}
{% block content %}

    {% from "forms/macros.html" import render_field %}
    {% if parts %}
        <h4>{{ _("Parts list :") }}</h4>
        <ul>
          {% for part in parts %}
            <li>{{ part.title }} - {{ part.content|truncate(30) }} -
                <a href="{{ url_for('books.edit_part', part_id=part.id, book_id=book.id) }}">
                    {{ _("Edit") }}
                </a> -
                <a href="{{ url_for('books.export_part', book_id=book.id, part_id=part.id, export_format='epub') }}">
                    {{ _("Export Epub") }}
                </a> -
                <a href="{{ url_for('books.del_part', part_id=part.id, book_id=book.id) }}">
                    {{ _("Delete") }}
                </a>
            </li>
          {% endfor %}
        </ul>
        <h4>{{ _("Not enough parts ? Are you sad ? ") }}</h4>
        <p class="bigger">
            <a href="{{ url_for('books.add_part', book_id=book.id) }}">
                {{ _("Then add some parts !") }}
            </a>
        </p>
    {% endif %}
    <form method="POST" action="{{ url_for('books.edit_part', part_id=part.id, book_id=book.id) }}" class="form">
        {{ form.hidden_tag() }}
        {{ render_field(form.title, class="input text line w70") }}
        {{ render_field(form.order, class="input text line w70") }}
        {{ render_field(form.content, class="input text invisible") }}
        <nav id="toolbar" class="pas line">
            <button type="button" data-command="h1" title="{{ _("Make selection Heading 1") }}">{{ _("Heading 1") }}</button>
            <button type="button" data-command="h2" title="{{ _("Make selection Heading 2") }}">{{ _("Heading 2") }}</button>
            <button type="button" data-command="h3" title="{{ _("Make selection Heading 3") }}">{{ _("Heading 3") }}</button>
            <button type="button" data-command="h4" title="{{ _("Make selection Heading 4") }}">{{ _("Heading 4") }}</button>
            <button type="button" data-command="bold" title="{{ _("Make selection bold") }}"><strong>{{ _("Bold") }}</strong></button>
            <button type="button" data-command="italic" title="{{ _("Make selection italic") }}"><em>{{ _("Italic") }}</em></button>
            <button type="button" data-command="code" title="{{ _("Make selection inline code block") }}">{{ _("Code") }}</button>
            <button type="button" data-command="list" title="{{ _("Make selection a unordered list") }}">{{ _("List") }}</button>
            <button type="button" data-command="olist" title="{{ _("Make selection a ordered list") }}">{{ _("Ordered List") }}</button>
        </nav>
        <div id="epiceditor-container" class="row man pan">
            <div id="epiceditor" class="col w50 man pan"></div>
            <div id="epiceditor-preview" class="col w50 man pan"></div>
        </div>
        <input type="submit" value="{{ _('Save') }}" class="button green">
    </form>
    <script src="{{ url_for('static', filename='js') }}/commands.js"></script>
    <script src="{{ url_for('static', filename='js') }}/toolbar.js"></script>
    {% include "editor.html" %}
{% endblock %}